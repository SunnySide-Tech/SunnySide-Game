<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<style>
		
			canvas {
				border:1px solid #d3d3d3;
				background-color: #f1f1f1;
				height:100%;
				width 100%;
			}
			
			button {
				margin:13px;
				color:black;
				height:40px;
				width: 40px;
				background-color:lightblue;
				padding: 14px 20px;
						
			}
			
		</style>
		
	</head>
	
	<body onload="startGame()">
		<script>
			var myDog, time, myBackground, obstacles, a, b, c, radius, left, right, top, bottom, otherLeft, otherRight, otherBottom, otherTop, crash, ctx; 

			obstacles = []; //defining multiple obstacles
				
			function startGame() {
				
				myDog = new component(130, 80, "huskyDrawing.png", 20, 180, "image"); //handrawn doggy
				myBackground = new component(1510, 710, "snow.jpg", 0, 0, "backgroundPic"); //1510 px wide, 730 px high, 0 px to the right and left
				time = new component("30px", "Consolas", "black", 30, 30, "text");
				obstacles = new component(300, 300, "SunnySide_Shrub.png", 400, 350, "obstacle");
				myGameArea.start();		
				
			}
			
			var myGameArea = {
			
				canvas : document.createElement("canvas"),
				
				start : function() {
				
					this.canvas.width = 1510;
					this.canvas.height = 710;
					this.context = this.canvas.getContext("2d");			
					document.body.insertBefore(this.canvas, document.body.childNodes[0]);
					this.frameNo = 0; //to generate more obstacles at a given frame rate
					this.interval = setInterval(updateGameArea, 20);
					
				},
				
				clear : function() {
				
					this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);
					
				},
				
				stop : function() {
				
					clearInterval(this.interval);
					
				}
				
			}
			
			function component(width, height, photo, x, y, type) {
			
				this.type = type;
				
				 if (type == "image" || type == "backgroundPic"||type == "obstacle") {
				 
					this.image = new Image();
					this.image.src = photo;
					
				 }
				this.width = width;
				this.height = height;
				this.speedX = 0;
				this.speedY = 0;    
				this.x = x;
				this.y = y; 
				this.score = 0;

				
				this.update = function() {
				
					ctx = myGameArea.context;
					if (type == "image"||type == "backgroundPic"||type == "obstacle") {
							
							ctx.drawImage(this.image, this.x, this.y, this.width, this.height);
							
							if (type == "backgroundPic"||type == "obstacle") {
								ctx.drawImage(this.image, this.x, this.y, this.width, this.height);
							}
								  
					} else if (this.type == "text") {
						
							ctx.font = this.width + " " + this.height;
							ctx.fillStyle = photo;
							ctx.fillText(this.text, this.x, this.y);
							
					} else {
						
						ctx.fillStyle = photo;
						ctx.fillRect(this.x, this.y, this.width, this.height);
						
					}
					
				} 
					
				this.newPos = function() {
				
					this.x += this.speedX;
					this.y += this.speedY; 
					
					if (this.type == "backgroundPic"||type == "obstacle") {
					
					   if (this.x == -(this.width)) {
					  
							this.x = 0;
						
					    }
					  
					}	
				}
				   this.crashWith = function(otherobj) {
					var myleft = this.x;
					var myright = this.x + (this.width);
					var mytop = this.y;
					var mybottom = this.y + (this.height);
					var otherleft = otherobj.x;
					var otherright = otherobj.x + (otherobj.width);
					var othertop = otherobj.y;
					var otherbottom = otherobj.y + (otherobj.height);
					var crash = true;
					if ((mybottom < othertop) || (mytop > otherbottom) || (myright < otherleft) || (myleft > otherright)) {
					  crash = false;
					}
					return crash;
				  }
			}
				
			
			function updateGameArea() {
		
				var x, height, interVal, minHeight, maxHeight, mininterVal, maxinterVal, y, width, minWidth, minHeight;
				
				for (var i = 0; i < obstacles.length; i += 1) {

					if (myDog.crashWith(obstacles[i])) {
						alert("You lost");
						myGameArea.stop();
					    return;
					  
					} 
					
				}
					myGameArea.clear(); //so that the components do not leave a trail behind on canvas
					myGameArea.frameNo += 1;
					myBackground.speedX = -1;
					myBackground.newPos();    //so the background image is continuous
					myBackground.update();
					
						if ((myGameArea.frameNo == 1 )|| (everyInterval(120))) {
							x = myGameArea.canvas.width
							minHeight = 20;
							maxHeight = 80;
							height = Math.floor(Math.random()*(maxHeight-minHeight+1)+minHeight);
							mininterVal = 100;
							maxinterVal = 200;
							interVal = Math.floor(Math.random()*(maxinterVal-mininterVal+1)+mininterVal);
							obstacles[obstacles.length] = (new component(10, height, "SunnySide_Shrub.png", x, 0, "obstacle")); //adds component properties to the end of the array
							obstacles[obstacles.length] = (new component(10, x - height - interVal, "SunnySide_Shrub.png", x, height + interVal));

						}
						
						for (var w = 0; w < obstacles.length; w += 1) {
			
							obstacles[w].x += 1; //chooses which obstacles property to display
							obstacles[w].update(); //updates and adds new one to canvas
							
						}
				time.text = "SCORE: " + myGameArea.frameNo;
				time.update();
				//obstacles.update();
				myDog.newPos();    
				myDog.update();
				
			}	
			
			
			function everyInterval(n) {
			
			  if ((myGameArea.frameNo / n) % 1 == 0) {
			  
				return true;
				
			  }
			  
			  return false;
			  
			}
			
			function moveup() {
			
				myDog.speedY = -2; 
				
			}

			function movedown() {
			
				myDog.speedY = 2; 
				
			}

			function moveleft() {
			
				myDog.speedX = -2; 
				
			}

			function moveright() {
			
				myDog.speedX = 2; 
				
			}
			
			document.onkeydown = function(evt) { //connecting the dog to arrows on keyboard
			
				evt = evt || window.event; 
				
				switch (evt.keyCode) { 
				
					case 37:
					moveleft(); 
					break; 
					 
					case 38:
					moveup(); 
					break;
					
					case 39:
					moveright(); 
					break; 
					
					case 40:
					movedown(); 
					break;
				
				} 
				
			};			
		</script>
	</body>
</html>

